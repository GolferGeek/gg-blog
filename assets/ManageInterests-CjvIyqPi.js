import{h as f,j as e,q as W,r as l,v as z,B as C,t as m,k as j,U as H,P as R,V as J,W as L,X as w,Y as s,Z as N,I as k,$ as U,a0 as V,a1 as q,J as d,y as E,a2 as F}from"./vendor-C65ctaoV.js";import{b as P,s as c}from"./index-I0dD487A.js";import{I as G,M as X}from"./MarkdownEditor-Csx3Eh72.js";import"./supabase-Cg6Q1mgr.js";import"./Delete-DyDZc2Gn.js";const Y=f(e.jsx("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"AddCircleOutlineOutlined"),Z=f(e.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM8 9h8v10H8zm7.5-5-1-1h-5l-1 1H5v2h14V4z"}),"DeleteOutlineOutlined"),$=f(e.jsx("path",{d:"m14.06 9.02.92.92L5.92 19H5v-.92zM17.66 3c-.25 0-.51.1-.7.29l-1.83 1.83 3.75 3.75 1.83-1.83c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29m-3.6 3.19L3 17.25V21h3.75L17.81 9.94z"}),"EditOutlined");function se(){const{user:a}=P(),b=W(),[O,S]=l.useState([]),[D,v]=l.useState(!1),[u,p]=l.useState(null),[i,r]=l.useState({title:"",description:"",image_path:"",content:""});l.useEffect(()=>{if(!a||a.email!=="golfergeek@gmail.com"){b("/");return}(async()=>{try{const{data:n}=await c.storage.listBuckets();if(!n.some(o=>o.name==="interest-images")){const{error:o}=await c.storage.createBucket("interest-images",{public:!0,allowedMimeTypes:["image/*"],fileSizeLimit:5242880});o&&console.error("Error creating bucket:",o)}}catch(n){console.error("Error in setupStorage:",n)}})(),g()},[a,b]);const g=async()=>{try{const{data:t,error:n}=await c.from("interests").select("*").order("title");if(n)throw n;S(t)}catch(t){console.error("Error fetching interests:",t)}},y=(t=null)=>{t?(p(t),r({title:t.title,description:typeof t.description=="object"?JSON.stringify(t.description,null,2):t.description||"",image_path:t.image_path||"",content:t.content||""})):(p(null),r({title:"",description:"",image_path:"",content:""})),v(!0)},x=()=>{v(!1),p(null),r({title:"",description:"",image_path:"",content:""})},I=t=>{const{name:n,value:h}=t.target;r(o=>({...o,[n]:h}))},T=t=>n=>{r(h=>({...h,[t]:n||""}))},_=t=>{t&&t.length>0&&r(n=>({...n,image_path:t[0]}))},M=()=>{r(t=>({...t,image_path:""}))},B=async()=>{try{const t={...i,description:i.description,user_id:(a==null?void 0:a.id)||null};if(u){const{error:n}=await c.from("interests").update(t).eq("id",u.id);if(n)throw n}else{const{error:n}=await c.from("interests").insert([t]);if(n)throw n}x(),g()}catch(t){console.error("Error saving interest:",t)}},A=async t=>{if(window.confirm("Are you sure you want to delete this interest?"))try{const{error:n}=await c.from("interests").delete().eq("id",t);if(n)throw n;g()}catch(n){console.error("Error deleting interest:",n)}};return e.jsxs(z,{maxWidth:"lg",sx:{mt:4},children:[e.jsxs(C,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(m,{variant:"h4",component:"h1",children:"Manage Interests"}),e.jsx(j,{variant:"contained",color:"primary",startIcon:e.jsx(Y,{}),onClick:()=>y(),children:"Add Interest"})]}),e.jsx(H,{component:R,children:e.jsxs(J,{children:[e.jsx(L,{children:e.jsxs(w,{children:[e.jsx(s,{children:"Title"}),e.jsx(s,{children:"Description"}),e.jsx(s,{children:"Image"}),e.jsx(s,{children:"Actions"})]})}),e.jsx(N,{children:O.map(t=>e.jsxs(w,{children:[e.jsx(s,{children:t.title}),e.jsx(s,{children:e.jsxs(m,{noWrap:!0,sx:{maxWidth:200},children:[typeof t.description=="object"?JSON.stringify(t.description).substring(0,100):(t.description||"").substring(0,100),(typeof t.description=="object"?JSON.stringify(t.description).length>100:(t.description||"").length>100)?"...":""]})}),e.jsx(s,{children:t.image_path&&e.jsx(C,{component:"img",src:t.image_path,alt:t.title,sx:{width:50,height:50,objectFit:"cover",borderRadius:1}})}),e.jsxs(s,{children:[e.jsx(k,{onClick:()=>y(t),color:"primary",children:e.jsx($,{})}),e.jsx(k,{onClick:()=>A(t.id),color:"error",children:e.jsx(Z,{})})]})]},t.id))})]})}),e.jsxs(U,{open:D,onClose:x,maxWidth:"md",fullWidth:!0,children:[e.jsx(V,{children:u?"Edit Interest":"Add Interest"}),e.jsx(q,{children:e.jsxs(d,{container:!0,spacing:2,children:[e.jsx(d,{item:!0,xs:12,children:e.jsx(E,{name:"title",label:"Title",value:i.title,onChange:I,fullWidth:!0,margin:"normal"})}),e.jsx(d,{item:!0,xs:12,children:e.jsx(E,{name:"description",label:"Description",value:i.description,onChange:I,fullWidth:!0,multiline:!0,rows:3,margin:"normal"})}),e.jsxs(d,{item:!0,xs:12,children:[e.jsx(m,{variant:"subtitle1",gutterBottom:!0,children:"Interest Image"}),e.jsx(G,{onUpload:_,onRemove:M,existingImages:i.image_path?[i.image_path]:[],bucket:"interest-images",folder:"interest-images"})]}),e.jsxs(d,{item:!0,xs:12,children:[e.jsx(m,{variant:"subtitle1",gutterBottom:!0,children:"Content"}),e.jsx(X,{value:i.content,onChange:T("content")})]})]})}),e.jsxs(F,{children:[e.jsx(j,{onClick:x,children:"Cancel"}),e.jsx(j,{onClick:B,variant:"contained",color:"primary",children:"Save"})]})]})]})}export{se as default};
//# sourceMappingURL=ManageInterests-CjvIyqPi.js.map
