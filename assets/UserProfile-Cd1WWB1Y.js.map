{"version":3,"file":"UserProfile-Cd1WWB1Y.js","sources":["../../src/pages/UserProfile.jsx"],"sourcesContent":["import { useState, useEffect } from 'react'\nimport { Box, TextField, Button, Typography, Container } from '@mui/material'\nimport MarkdownEditor from '../components/MarkdownEditor'\nimport ImageUpload from '../components/ImageUpload'\nimport { supabase } from '../lib/supabase'\n\nconst UserProfile = () => {\n  const [username, setUsername] = useState('')\n  const [resume, setResume] = useState('')\n  const [logo, setLogo] = useState('')\n  const [tagline, setTagline] = useState('')\n  const [loading, setLoading] = useState(false)\n  const [message, setMessage] = useState('')\n\n  useEffect(() => {\n    getProfile()\n  }, [])\n\n  const getProfile = async () => {\n    try {\n      const { data: { user } } = await supabase.auth.getUser()\n      if (!user) throw new Error('No user found')\n\n      const { data, error } = await supabase\n        .from('profiles')\n        .select('username, resume, logo, tagline')\n        .eq('id', user.id)\n        .single()\n\n      if (error) throw error\n\n      if (data) {\n        setUsername(data.username || '')\n        setResume(data.resume || '')\n        setLogo(data.logo || '')\n        setTagline(data.tagline || '')\n      }\n    } catch (error) {\n      console.error('Error fetching profile:', error.message)\n      setMessage('Error fetching profile')\n    }\n  }\n\n  const handleLogoUpload = (uploadedImages) => {\n    if (uploadedImages && uploadedImages.length > 0) {\n      setLogo(uploadedImages[0])\n    }\n  }\n\n  const handleLogoRemove = async () => {\n    setLogo('')\n  }\n\n  const updateProfile = async () => {\n    try {\n      setLoading(true)\n      const { data: { user } } = await supabase.auth.getUser()\n      if (!user) throw new Error('No user found')\n\n      const updates = {\n        id: user.id,\n        username,\n        resume,\n        logo,\n        tagline,\n      }\n\n      const { error } = await supabase\n        .from('profiles')\n        .upsert(updates)\n\n      if (error) throw error\n      setMessage('Profile updated successfully')\n    } catch (error) {\n      console.error('Error updating profile:', error.message)\n      setMessage('Error updating profile')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  return (\n    <Container maxWidth=\"md\">\n      <Box sx={{ mt: 4, mb: 2 }}>\n        <Typography variant=\"h4\" component=\"h1\" gutterBottom>\n          User Profile\n        </Typography>\n        {message && (\n          <Typography color={message.includes('Error') ? 'error' : 'success'} gutterBottom>\n            {message}\n          </Typography>\n        )}\n      </Box>\n\n      <Box component=\"form\" noValidate sx={{ mt: 1 }}>\n        <TextField\n          margin=\"normal\"\n          required\n          fullWidth\n          label=\"Username\"\n          value={username}\n          onChange={(e) => setUsername(e.target.value)}\n          disabled={loading}\n        />\n\n        <TextField\n          margin=\"normal\"\n          fullWidth\n          label=\"Tagline\"\n          value={tagline}\n          onChange={(e) => setTagline(e.target.value)}\n          disabled={loading}\n          helperText=\"A brief description that appears on the home page\"\n        />\n\n        <Box sx={{ mt: 2, mb: 2 }}>\n          <Typography variant=\"subtitle1\" gutterBottom>\n            Resume (Markdown)\n          </Typography>\n          <MarkdownEditor\n            value={resume}\n            onChange={setResume}\n          />\n        </Box>\n\n        <Box sx={{ mt: 2, mb: 2 }}>\n          <Typography variant=\"subtitle1\" gutterBottom>\n            Logo\n          </Typography>\n          <ImageUpload \n            onUpload={handleLogoUpload}\n            onRemove={handleLogoRemove}\n            existingImages={logo ? [logo] : []}\n            bucket=\"profile_logos\"\n            showCopyOption={false}\n          />\n        </Box>\n\n        <Button\n          fullWidth\n          variant=\"contained\"\n          onClick={updateProfile}\n          disabled={loading}\n          sx={{ mt: 3, mb: 2 }}\n        >\n          {loading ? 'Saving...' : 'Save Profile'}\n        </Button>\n      </Box>\n    </Container>\n  )\n}\n\nexport default UserProfile\n"],"names":["UserProfile","username","setUsername","useState","resume","setResume","logo","setLogo","tagline","setTagline","loading","setLoading","message","setMessage","useEffect","getProfile","user","supabase","data","error","handleLogoUpload","uploadedImages","handleLogoRemove","updateProfile","updates","jsxs","Container","Box","jsx","Typography","TextField","MarkdownEditor","ImageUpload","Button"],"mappings":"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"}