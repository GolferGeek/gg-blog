import{r as o,j as t,v as S,B as n,t as i,y as v,k as B}from"./vendor-C65ctaoV.js";import{M as C,I as P}from"./MarkdownEditor-Csx3Eh72.js";import{s as l}from"./index-I0dD487A.js";import"./Delete-DyDZc2Gn.js";import"./supabase-Cg6Q1mgr.js";const W=()=>{const[g,f]=o.useState(""),[h,p]=o.useState(""),[u,c]=o.useState(""),[x,j]=o.useState(""),[a,b]=o.useState(!1),[d,m]=o.useState("");o.useEffect(()=>{w()},[]);const w=async()=>{try{const{data:{user:e}}=await l.auth.getUser();if(!e)throw new Error("No user found");const{data:r,error:s}=await l.from("profiles").select("username, resume, logo, tagline").eq("id",e.id).single();if(s)throw s;r&&(f(r.username||""),p(r.resume||""),c(r.logo||""),j(r.tagline||""))}catch(e){console.error("Error fetching profile:",e.message),m("Error fetching profile")}},y=e=>{e&&e.length>0&&c(e[0])},E=async()=>{c("")},U=async()=>{try{b(!0);const{data:{user:e}}=await l.auth.getUser();if(!e)throw new Error("No user found");const r={id:e.id,username:g,resume:h,logo:u,tagline:x},{error:s}=await l.from("profiles").upsert(r);if(s)throw s;m("Profile updated successfully")}catch(e){console.error("Error updating profile:",e.message),m("Error updating profile")}finally{b(!1)}};return t.jsxs(S,{maxWidth:"md",children:[t.jsxs(n,{sx:{mt:4,mb:2},children:[t.jsx(i,{variant:"h4",component:"h1",gutterBottom:!0,children:"User Profile"}),d&&t.jsx(i,{color:d.includes("Error")?"error":"success",gutterBottom:!0,children:d})]}),t.jsxs(n,{component:"form",noValidate:!0,sx:{mt:1},children:[t.jsx(v,{margin:"normal",required:!0,fullWidth:!0,label:"Username",value:g,onChange:e=>f(e.target.value),disabled:a}),t.jsx(v,{margin:"normal",fullWidth:!0,label:"Tagline",value:x,onChange:e=>j(e.target.value),disabled:a,helperText:"A brief description that appears on the home page"}),t.jsxs(n,{sx:{mt:2,mb:2},children:[t.jsx(i,{variant:"subtitle1",gutterBottom:!0,children:"Resume (Markdown)"}),t.jsx(C,{value:h,onChange:p})]}),t.jsxs(n,{sx:{mt:2,mb:2},children:[t.jsx(i,{variant:"subtitle1",gutterBottom:!0,children:"Logo"}),t.jsx(P,{onUpload:y,onRemove:E,existingImages:u?[u]:[],bucket:"profile_logos",showCopyOption:!1})]}),t.jsx(B,{fullWidth:!0,variant:"contained",onClick:U,disabled:a,sx:{mt:3,mb:2},children:a?"Saving...":"Save Profile"})]})]})};export{W as default};
//# sourceMappingURL=UserProfile-Cd1WWB1Y.js.map
