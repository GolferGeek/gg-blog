import{f as S,j as e,u as I,r as o,P as C,B as s,k as i,L as b,S as v,v as k,m as y,h as D,w as E,x as P,y as M}from"./vendor-B9LkEojj.js";import{a as A,s as w}from"./index-Dm5WVTMK.js";import{f as F,C as B}from"./ConfirmModal-CrAl7VSQ.js";const L=S(e.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search");function T({post:r,onDelete:d}){const{user:c}=A(),h=I(),[l,g]=o.useState(!1),[m,x]=o.useState(null),u=c&&c.id===r.user_id,p=t=>{if(!t)return null;const n=/!\[.*?\]\((.*?)\)/,a=t.match(n);return a?a[1]:null};o.useEffect(()=>{const t=p(r.content);t&&x(t)},[r.content]);async function f(){try{const{error:t}=await w.from("images").delete().eq("post_id",r.id);if(t)throw t;const{error:n}=await w.from("posts").delete().eq("id",r.id);if(n)throw n;d&&d(r.id),g(!1)}catch(t){console.error("Error deleting post:",t),alert("Error deleting post. Please try again.")}}const j=()=>{var n,a;switch((a=(n=r.interests)==null?void 0:n[0])==null?void 0:a.toLowerCase()){case"coder":return"/images/coder.jpg";case"golfer":return"/images/golfer.jpg";case"mentor":return"/images/mentor.jpg";case"aging":return"/images/aging.jpg";default:return"/images/coder.jpg"}};return e.jsxs(e.Fragment,{children:[e.jsx(C,{elevation:3,sx:{p:2,width:"100%"},children:e.jsxs(s,{sx:{display:"flex",gap:3},children:[e.jsx(s,{component:"img",src:m||j(),alt:r.title,sx:{width:150,height:150,objectFit:"cover",borderRadius:1,flexShrink:0}}),e.jsxs(s,{sx:{flex:1,display:"flex",flexDirection:"column"},children:[e.jsxs(s,{sx:{mb:1},children:[e.jsx(i,{variant:"h6",component:b,to:`/post/${r.id}`,sx:{textDecoration:"none",color:"text.primary","&:hover":{color:"primary.main"}},children:r.title}),e.jsxs(s,{sx:{display:"flex",gap:2,alignItems:"center",mt:.5},children:[e.jsx(v,{direction:"row",spacing:1,children:r.interests.map(t=>e.jsx(k,{label:t,size:"small",color:"primary",variant:"outlined"},t))}),e.jsx(i,{variant:"body2",color:"text.secondary",children:F(new Date(r.created_at),"MMMM d, yyyy")})]})]}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:2,display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"},children:r.excerpt}),e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:"auto"},children:[e.jsx(y,{component:b,to:`/post/${r.id}`,variant:"contained",color:"primary",size:"small",children:"Read More"}),u&&e.jsxs(v,{direction:"row",spacing:1,children:[e.jsx(y,{onClick:()=>h(`/edit/${r.id}`),variant:"outlined",color:"primary",size:"small",children:"Edit"}),e.jsx(y,{onClick:()=>g(!0),variant:"outlined",color:"error",size:"small",children:"Delete"})]})]})]})]})}),e.jsx(B,{open:l,onClose:()=>g(!1),onConfirm:f,title:"Delete Post",message:"Are you sure you want to delete this post? This action cannot be undone."})]})}function _({category:r,title:d}){const[c,h]=o.useState([]),[l,g]=o.useState(""),[m,x]=o.useState(!0);o.useEffect(()=>{u()},[l,r]);async function u(){try{x(!0);let t=w.from("posts").select("*").contains("interests",[r]).order("created_at",{ascending:!1});l?(t=t.ilike("title",`%${l}%`),t=t.limit(10)):t=t.limit(4);const{data:n,error:a}=await t;if(a)throw a;h(n)}catch(t){console.error("Error fetching posts:",t)}finally{x(!1)}}const p=async t=>{h(c.filter(n=>n.id!==t))},f=()=>{switch(r){case"coder":return"/images/coder.jpg";case"golfer":return"/images/golfer.jpg";case"mentor":return"/images/mentor.jpg";case"aging":return"/images/aging.jpg";default:return"/images/coder.jpg"}},j=()=>{switch(r){case"coder":return"Exploring the world of programming and software development";case"golfer":return"Sharing golf experiences, tips, and achievements";case"mentor":return"Guiding and supporting others in their journey";case"aging":return"Insights and reflections on the aging process";default:return""}};return e.jsxs(s,{children:[e.jsxs(s,{sx:{mb:6},children:[e.jsx(s,{sx:{position:"relative",height:"300px",overflow:"hidden"},children:e.jsx(s,{component:"img",src:f(),alt:d,sx:{width:"100%",height:"100%",objectFit:"cover"}})}),e.jsxs(s,{sx:{textAlign:"center",bgcolor:"background.paper",py:4},children:[e.jsx(i,{variant:"h2",component:"h1",gutterBottom:!0,children:d}),e.jsx(i,{variant:"h5",component:"p",sx:{maxWidth:"800px",mx:"auto"},children:j()})]})]}),e.jsx(D,{maxWidth:"lg",children:e.jsxs(C,{elevation:3,sx:{p:4,mb:4},children:[e.jsx(E,{fullWidth:!0,variant:"outlined",placeholder:"Search posts...",value:l,onChange:t=>g(t.target.value),InputProps:{startAdornment:e.jsx(P,{position:"start",children:e.jsx(L,{})})},sx:{mb:2}}),m?e.jsx(s,{sx:{display:"flex",justifyContent:"center",p:4},children:e.jsx(M,{})}):c.length>0?e.jsx(v,{spacing:4,children:c.map(t=>e.jsx(s,{children:e.jsx(T,{post:t,onDelete:p})},t.id))}):e.jsxs(s,{sx:{textAlign:"center",py:4},children:[e.jsx(i,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No posts found"}),e.jsx(i,{color:"text.secondary",paragraph:!0,children:"Try adjusting your search or check back later for new content."})]})]})})]})}export{_ as I};
//# sourceMappingURL=InterestPage-93g_Bia_.js.map
